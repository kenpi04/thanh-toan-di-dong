@model TopMenuModel
@using Nop.Web.Models.Catalog;
@{
    var isRtl = this.ShouldUseRtlTheme();    
}
@helper RenderCategoryLine(CategorySimpleModel category, int level)
{
   
    <li>
        <a href="@Url.RouteUrl("Category", new { SeName = category.SeName })">@category.Name
        @if (category.NumberOfProducts.HasValue)
        {
            <text> </text>@T("Categories.TotalProducts", category.NumberOfProducts.Value)
        }
        </a>
        @{
            var levelClass = "";
            if (level == 0)
            {
                levelClass = "firstLevel";
            
            }
             <div class="sublist">
                 <div class="menu-title">
                     <span>Theo địa điểm</span>
@if(category.SubCategories.Count>0)
                {
                     <span>Theo loại</span>
}
                     <span>Giá</span>
                 </div>
                <ul>
  
                    @foreach(var d in Model.Districts)
                    {
                        <li><a href="@GetSeName(Request.Url.Host, category.SeName, d.Value)">@d.Text</a></li>
                    }
                </ul>
                @if(category.SubCategories.Count>0)
                { 
                <ul>
                    <li></li>
                    @foreach (var subCategory in  category.SubCategories)
                    {
                        <li><a href="@Url.RouteUrl("Category", new {SeName=subCategory.SeName })">@subCategory.Name</a></li>
                    }
                  
                </ul>
                }
                
                <ul>
                   
                    @foreach (var d in Model.PriceRange)
                    {
                        <li><a href="@GetSeName(Request.Url.Host, category.SeName, null, null, d.Value, null)">@d.Text</a></li>
                    }
                </ul>
            </div>
            
        }
    </li>
}

<div id="top-menu" class="menu">
<ul>
    @Html.Widget("header_menu_before")
    @if (Model.Categories.Count > 0)
    {
        foreach (var category in Model.Categories)
        {
            @RenderCategoryLine(category, 0)
        }
    }
    else
    {
        //no categories to display?
        //in this cae let's diplay some default menu items
        <li><a href="@Url.RouteUrl("HomePage")">@T("HomePage")</a></li>
        if (Model.RecentlyAddedProductsEnabled)
        {
            <li><a href="@Url.RouteUrl("RecentlyAddedProducts")">@T("Products.NewProducts")</a>
            </li>
        }
        <li><a href="@Url.RouteUrl("ProductSearch")">@T("Search")</a> </li>
        <li><a href="@Url.RouteUrl("CustomerInfo")">@T("Account.MyAccount")</a></li>
        if (Model.BlogEnabled)
        {
            <li><a href="@Url.RouteUrl("Blog")">@T("Blog")</a></li>
        }
        if (Model.ForumEnabled)
        {
            <li><a href="@Url.RouteUrl("Boards")">@T("Forum.Forums")</a></li>
        }
        <li><a href="@Url.RouteUrl("ContactUs")">@T("ContactUs")</a></li>
    }

    <li><a href="#">Dịch vụ</a>
         <div class="top-menu-triangle"></div>
        <div class="sublist service">
            <ul>
                <li><a href="#">Tư vấn mua bán Nhà Đất</a></li>
                 <li><a href="#">Hổ trợ pháp lý</a></li>
                 <li><a href="#">Quảng cáo nhà đất</a></li>
                 <li><a href="#">Hổ trợ vay vốn ngân hàng</a></li>
                 <li><a href="#">Tư vấn đầu tư</a></li>

            </ul>
        </div>
    </li>

    <li><a>Kiến thức</a>
          <div class="top-menu-triangle"></div>
        <div class="sublist kienthuc">
            <ul>
                @foreach (var c in Model.CategoriesNews)
                { 
                    <li><a href="@Url.RouteUrl("NewsArchive", new {SeName=c.Value })">@c.Text</a></li>
                }
              </ul>
            </div>

    </li>

<li>
    <a href="#">Hỏi đáp</a>
</li>


<li>
    <a style="color:#fff" class="blueBtn" href="@Url.RouteUrl("InsertProduct")">Gửi yêu cầu</a>
</li>
 @*<li class="verLine"></li>
    <li><input type="button" class="lockBtn"></li>
    <li class="verLine"></li>
    <li><input type="button" class="searchBtn"></li>
    <li class="verLine"></li>*@
    @Html.Widget("header_menu_after")
</ul>
</div>
<script type="text/javascript">
    $('#top-menu li[class!=verLine]').on('mouseenter', function () {
        $('a', $(this)).first().addClass('hover');
        if (!$(this).parent().hasClass('top-menu')) {
            var width = $(this).innerWidth();
            $('.sublist', $(this)).first().css('@(isRtl ? "right" : "left")', width -45);
        }
        $('.sublist', $(this)).first().addClass('active');
        $('.top-menu-triangle', $(this)).addClass('active');
    });
    $('#top-menu li[class!=verLine]').on('mouseleave', function () {
        $('a', $(this)).first().removeClass('hover');
        $('.sublist', $(this)).first().removeClass('active');
        $('.top-menu-triangle', $(this)).removeClass('active');
    });
</script>