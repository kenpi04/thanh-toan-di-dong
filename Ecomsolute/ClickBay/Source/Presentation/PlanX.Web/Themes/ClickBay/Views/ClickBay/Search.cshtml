@model PlanX.Web.Models.ClickBay.SearchModel
@{
    Layout = "~/Views/Shared/_ColumnOne.cshtml";
}

<div class="wrapper-body">
    <div class="wrapper-content inline">
        <section class="section-top">
            <div class="breadcrumb">
                <p><span>Trang chủ</span><img src="styles/images/forward-icon.png" class="icon-small"><span>Tìm kiếm</span><img src="styles/images/forward-icon.png" class="icon-small"><span class="active">Chọn chuyến bay</span><img src="styles/images/forward-icon.png" class="icon-small"><span>Khách hàng</span><img src="styles/images/forward-icon.png" class="icon-small"><span>Thanh toán</span><img src="styles/images/forward-icon.png" class="icon-small"><span>Xác nhận</span></p>
            </div>
            <div class="info-filter">
                <p>
                    <span class="info-title-search">@Model.FromName</span><span>đi</span><span class="info-title-search">@Model.ToName</span><span style="color:#000">|</span>
                  
                     <span>Ngày</span><span class="info-title-search">@Model.DepartDate</span>
                </p>
            </div>
            <div class="info-passenger">
                <p><span>Số lượng người lớn:</span><span>@Model.Adult</span><span>Số lượng trẻ em:</span><span>@Model.Child</span><span>Số lượng em bé:</span><span>@Model.Flant</span></p>
            </div>

            @if(Model.Return)
            {
                
            }
        </section>
        <section class="section-left-search section" id="table-data" style="width:75%">
        </section>
        @if(Model.Return)
        { 
         <section class="section-top">
         
            <div class="info-filter">
                <p>
                    <span class="info-title-search">@Model.ToName</span><span>đi</span><span class="info-title-search">@Model.FromName</span><span style="color:#000">|</span>
                  
                     <span>Ngày</span><span class="info-title-search">@Model.ReturnDate </span>
                </p>
            </div>
            <div class="info-passenger">
                <p><span>Số lượng người lớn:</span><span>@Model.Adult</span><span>Số lượng trẻ em:</span><span>@Model.Child</span><span>Số lượng em bé:</span><span>@Model.Flant</span></p>
            </div>

        </section>
        <section class="section-left-search section" id="table-data-return" style="width:75%">
        </section>
        }
        <section class="section-right-search">
            <article>
                <aside>
                    <div class="box-sort">
                        <div class="title box-head">
                            <span class="title-left">Sắp xếp</span>
                        </div>
                        <div class="box-content">
                            <p><input type="radio"  checked="checked" value="1" name="radioSort"><span>Giá (thấp -&gt; cao)</span></p>
                            <p><input type="radio"  value="2" name="radioSort"><span>Thời gian đi</span></p>
                            <p><input type="radio"  value="3" name="radioSort"><span>Hãng hàng không</span></p>
                        </div>
                    </div>
                </aside>
                <aside>
                    <div class="box-filter">
                        <div class="title box-head">
                            <span class="title-left">Lọc theo hãng hàng không</span>
                        </div>
                        <div class="box-content">
                            <p><input type="checkbox" name="checkFlight" value="VietnamAirlines"><span>VietNam Arilines</span></p>
                            <p><input type="checkbox" name="checkFlight" value="JetStar"><span>JetStart</span></p>
                            <p><input type="checkbox" name="checkFlight" value="VietJetAir"><span>Vietjet Air</span></p>
                        </div>
                    </div>
                </aside>
            
                @Html.Action("SearchBox", new {isSmall=true })

            </article>
        </section>

        </div>
    </div>
<script type="text/javascript">
    $(document).ready(function () {
        search();
        $("input[name=radioSort]").click(function(){
            search();
        })
    })
    function search()
    {
        var selectedSource=[];
        $("input[name=checkFlight]:checked").each(function(i,e){
                selectedSource.push($(this).val())
        });            
        var data = {
            FromID:'@(Model.FromId!=null?Model.FromId:"")',
            ToId:'@(Model.ToId!=null?Model.ToId:"")',
            DepartDate: '@Model.DepartDate',
            ReturnDate:'@Model.ReturnDate', 
            Adult:@Model.Adult,
            Child:@Model.Child,
            Flant:@Model.Flant,
            Sort:$("input[name=radioSort]:checked").val(),
            Source:selectedSource,
            SessionId: $("#sessionid").val()??""
           
        };
        displayAjaxLoading(true);
        $.get("@Url.Action("TicketSearch")",data,function(d){
            $("#table-data").html(d);
            displayAjaxLoading(false)
        }).error(function(){
            alert("Lỗi kết nối! vui lòng thử lại");
            displayAjaxLoading(false);
        })
        @if(Model.Return)
                {<text>
                     var data = {
                    FromID:'@(Model.ToId != null ? Model.ToId : "")',
                    ToId:'@(Model.FromId != null ? Model.FromId : "")',
                    DepartDate: '@Model.ReturnDate',
                    Adult:@Model.Adult,
                    Child:@Model.Child,
                    Flant:@Model.Flant,
                    Sort:$("input[name=radioSort]:checked").val(),
                    Source:selectedSource,
                    SessionId: $("#sessionid-return").val()?""
           
                };
                displayAjaxLoading(true);
                $.get("@Url.Action("TicketSearch")",data,function(d){
                    $("#table-data").html(d);
                    displayAjaxLoading(false)
                }).error(function(){
                    alert("Lỗi kết nối! vui lòng thử lại");
                    displayAjaxLoading(false);
                })</text>
        }
    }
</script>

        


