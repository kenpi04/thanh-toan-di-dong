@model ThanhToanDiDong.Models.Payment.TopupModel
@{
    Layout = null;
    }

@using (Html.BeginForm("Topup", "Payment", new {role="form",id="frmBuy" }))
{ 
    @Html.ValidationSummary(true);
  <div class="form-group">
    <label for="txtPhone">Số điện thoại:</label>
    @Html.TextBoxFor(x => x.Phone, new {maxlength = "15", @class = "form-control", placeholder = "Nhập số điện thoại" })
    @Html.ValidationMessageFor(x => x.Phone)
  </div>
   <div class="form-group">
       <label for="ddlPrice">Mệnh giá:</label>
       @Html.DropDownListFor(x => x.PriceListId, Model.PriceList, "Chọn mệnh giá", new {@class="form-control" })
   </div>
  <button type="submit" class="btn btn-primary">Gửi</button>


}
<script type="text/javascript">
    $(document).ready(function () { 
    $("#@Html.IdFor(x=>x.Phone)").focusout(function () {
        var value = $("#@Html.IdFor(x=>x.Phone)").val();      
        var ddlCate = $("#@Html.IdFor(x=>x.PriceListId)");
        ddlCate.html("<option value=0>Chọn mệnh giá</option");
        $.ajax({
            type: "GET",
            url: "@Url.Action("GetCategory")",
            data: { phone: value },
            success: function (data) {
                if(data == "")
                    return;
                $.each(data, function (index, value) {
                    ddlCate.append($("<option></option>").val(value.Value).text(value.Text));
                })
            },
            error: function () {
                ddlCate.html("<option value=0>Chọn mệnh giá</option");
            }
        });
    })
    })
</script>

